-------------------------------------------------------------------------------------------
How to update mappings of PT and Drugbank URI - Table: FDA_SUBSTANCE_TO_DRUGBANK_BIO2RDF
-------------------------------------------------------------------------------------------

(1) run the script parseDBIdBySynsInchiName.py with drugbank.xml , UNII Names and UNII Records from Data_Source/

$ parseDBIdBySynsInchiName.py 0 > Name_Syns_UNII_DbId_0.txt

output terms: FDA_Preferred_Term      UNII    Drugbank drug   drugbank id
output file: INCHI-OR-Syns-OR-Name.txt

INCHI OR Name OR Synonym:
- script output: Name_Syns_UNII_DbId_0.txt
- converted to unique list of mappings using:

$ cat Name_Syns_UNII_DbId_0.txt | cut -f1,3,4,5 | sort | uniq  > INCHI-OR-Syns-OR-Name.txt

- 2809 mappings by 06/10/2016

(2) add Drug bank base URI to update table: FDA_SUBSTANCE_TO_DRUGBANK_BIO2RDF

$ python scripts/addBio2rdf_UNII_to_DrugBank.py > fda-substance-preferred-name-to-drugbank.txt

load int Mysql:

$ mysql -u root -p --local-infile linkedSPLs

LOAD DATA LOCAL INFILE './fda-substance-preferred-name-to-drugbank.txt'INTO TABLE FDA_SUBSTANCE_TO_DRUGBANK_BIO2RDF(PreferredSubstance, DRUGBANK_CA, DRUGBANK_BIO2RDF);


-------------------------------------------------------------------------------------------
How to update mappings of PT and Drugbank URI, RxNorm
-------------------------------------------------------------------------------------------

Once tables FDA_SUBSTANCE_TO_DRUGBANK_BIO2RDF and FDAPreferredSubstanceToRxNORM are loaded in linkedSPLs schema. The query below would return mappings of Preferred term, Drugbank URI and RxNorm

Left join drugbank mapping with rxnorm mapping (2809 by 06/10/2016)

SELECT db.PreferredSubstance, db.DRUGBANK_CA, rx.RxNORM FROM FDA_SUBSTANCE_TO_DRUGBANK_BIO2RDF db
left join FDAPreferredSubstanceToRxNORM rx 
on rx.PreferredSubstance = db.PreferredSubstance;

Export query ressults to tsv:

SELECT db.PreferredSubstance, db.DRUGBANK_CA, rx.RxNORM FROM FDA_SUBSTANCE_TO_DRUGBANK_BIO2RDF db
LEFT JOIN FDAPreferredSubstanceToRxNORM rx 
ON rx.PreferredSubstance = db.PreferredSubstance
INTO OUTFILE '/tmp/pt-drugbank-rxnorm-unconservetive-mapping-06232016.tsv'
FIELDS TERMINATED BY '\t'
LINES TERMINATED BY '\n';


full mapping (1395 by 06/10/2016)

SELECT db.PreferredSubstance, db.DRUGBANK_CA, rx.RxNORM FROM FDA_SUBSTANCE_TO_DRUGBANK_BIO2RDF db
join FDAPreferredSubstanceToRxNORM rx 
on rx.PreferredSubstance = db.PreferredSubstance;

------------------------------------------------------------------------------
Deprecated - Old apporach that querying bioportal
------------------------------------------------------------------------------

run script parseDBIdAndChEBI.py to get mappings of UNIIs drugbank
URI and chebi URI. This script depends on UNIIToChEBI.txt which was generated using code at bio2rdf/linkedSPLs/LinkedSPLs-update/mappings/PT-UNII-ChEBI-mapping

$ python parseDBIdAndChEBI.py <path/to/drugbank.xml> > drugbank-to-chebi.txt

output terms: FDA Preferred Term, DrugBank Term, ChEBI URI, DrugBank URI
output file: drugbank-to-chebi.txt

(2) The script combineDrugBankMappings.py was ran to output a combined
mapping that indicated what kind of mapping was used.


TODO: other properties may use as key to generate new mappings of drugbank id and UNIIs
UNII MF EINECS RN NCIt ITIS NCBI PLANTS SMILES


(3) The final VALIDATED FDA Preferred name to ChEBImapping was exported to FDA_UNII_to_ChEBI_03132014.txt (NOTE: file is ASCII encoded)

$ cat FDA_UNII_to_ChEBI_03132014.txt | cut -f 1,3 -d '|' > FDA_UNII_to_ChEBI-04082014.txt

LOAD DATA LOCAL INFILE './FDA_UNII_to_ChEBI_04082014.txt' INTO TABLE FDA_UNII_to_ChEBI FIELDS TERMINATED BY '|' LINES TERMINATED BY '\n' (PreferredSubstance, ChEBI); 

